# 算术电路 (Arithmetic Circuits)

## 🎓 第一部分：引言与课程目标 

### **1.1 课程信息**
*   **课程代码与名称:** 数字电子学基础
*   **讲座主题:** 算术电路

### **1.2 学习目标 (Objectives)**
本讲座的核心目标是理解并设计用于执行基本算术运算的数字电路。具体包括：
1.  **二进制算术与补码:** 掌握二进制加减法规则，并学习用于表示负数和执行减法的**二进制补码** (Two's Complement) 方法。
2.  **加法器电路:** 学习设计和构建**半加器 (Half-Adder)** 和**全加器 (Full-Adder)** 电路。
3.  **比较器电路:** 学习设计用于比较两个二进制数大小的**比较器 (Comparator)** 电路。

---

## ➕ 第二部分：二进制加法与加法器

### **2.1 二进制加法规则**
二进制加法按位相加，并处理进位，规则如下：
*   `0 + 0 = 0` (进位 0)
*   `0 + 1 = 1` (进位 0)
*   `1 + 0 = 1` (进位 0)
*   `1 + 1 = 0` (进位 1)
*   `1 + 1 + 1 = 1` (进位 1) (包含来自低位的进位)

> **核心思想:** 当任意列的和超过1时，需要向更高位（左侧的下一列）产生一个**进位 (Carry)**。

### **2.2 N位加法器的挑战**
直接为N位加法器（例如，两个N位数相加）构建一个完整的真值表是**不现实**的。
*   **问题:** 输入数量为 `2N`。真值表的行数将是 **`2²ᴺ`**。
    *   2位加法器: `2⁴ = 16` 行 (可管理)
    *   5位加法器: `2¹⁰ = 1024` 行
    *   32位加法器: `2⁶⁴ ≈ 1.8 × 10¹⁹` 行 (无法实现)
*   **结论:** 必须采用一种**模块化**的设计方法，将大问题分解为小问题。

### **2.3 解决方案：模块化设计 - 半加器与全加器**
我们将N位加法问题分解为N个独立的“列”加法。每一列的加法由一个专门的电路模块完成。

#### **2.3.1 半加器 (Half-Adder - HA)**
*   **功能:** 对两个**单位**二进制数 (`a` 和 `b`) 进行相加。
*   **应用:** 仅适用于**最低有效位 (LSB)** 的加法，因为它没有来自更低位的进位输入。
*   **输入:** `a`, `b`
*   **输出:** `S` (和), `Co` (向高位的进位)
*   **逻辑方程:**
    *   `S = a'b + ab' = a ⊕ b` (异或门)
    *   `Co = a · b` (与门)
*   **电路实现:** 由一个**异或门 (XOR)** 和一个**与门 (AND)** 构成。

#### **2.3.2 全加器 (Full-Adder - FA)**
*   **功能:** 对三个**单位**二进制数 (`a`, `b` 和来自低位的进位 `Ci`) 进行相加。
*   **应用:** 适用于除LSB外的所有其他位的加法。
*   **输入:** `a`, `b`, `Ci` (进位输入)
*   **输出:** `S` (和), `Co` (进位输出)
*   **逻辑方程:**
    *   `S = a ⊕ b ⊕ Ci`
    *   `Co = ab + Ci(a ⊕ b)`  (等价于 `ab + aCi + bCi`)
*   **电路实现:** 可以由**两个半加器**和一个**或门**构成，或者直接用XOR、AND、OR门实现。

### **2.4 行波进位加法器 (Carry-Ripple Adder)**
通过将半加器和全加器**串联**起来，可以构建任意位数的加法器。
*   **结构:**
    1.  最低有效位 (Bit 0) 使用一个**半加器** (或将`Ci`接地的全加器)。
    2.  其余位 (Bit 1 到 N-1) 使用**全加器**。
    3.  **关键连接:** 第 `i` 位的进位输出 `Co` 连接到第 `i+1` 位的进位输入 `Ci`。
*   **命名:** 进位信号像波浪一样从低位“传播”到高位，因此得名“行波进位”。

### **2.5 加法器的级联 (Cascading Adders)**
通过将较小编元的加法器模块连接起来，可以构建更大规模的加法器。
*   **示例:** 使用两个4位加法器构建一个8位加法器。
    1.  第一个4位加法器处理低4位 (bits 0-3) 的加法。
    2.  其进位输出 `Co` 作为第二个4位加法器的进位输入 `Ci`，用于处理高4位 (bits 4-7) 的加法。
*   **优势:** 这种模块化和可扩展性是数字系统设计的核心原则。

---

## ➖ 第三部分：二进制减法与减法器 

### **3.1 二进制减法规则**
二进制减法按位进行，并处理借位。
*   `0 - 0 = 0` (借位 0)
*   `1 - 0 = 1` (借位 0)
*   `1 - 1 = 0` (借位 0)
*   `0 - 1 = 1` (借位 1)

> **核心思想:** 当被减数为 `0` 减数为 `1` 时，需要向更高位（左侧的下一列）**借位 (Borrow)**，使当前位的 `0` 变为 `10` (十进制的2) 再进行计算。

### **3.2 二进制补码 (Two's Complement)**
这是一种在数字系统中表示负数，并将**减法运算转换为加法运算**的关键技术。
*   **定义:** 一个N位二进制数 `B` 的二进制补码等于 `2ᴺ - B`。
*   **快速计算方法:** **“各位取反，末位加一”**。
    *   **示例 (4位):** `0011` (3) 的补码
        1.  取反: `1100`
        2.  加一: `1100 + 1 = 1101` (-3)
*   **符号位:** 在补码表示中，**最高有效位 (MSB)** 作为符号位。`0` 代表正数，`1` 代表负数。

### **3.3 使用加法器构建减法器**
*   **核心原理:**
    > **`A - B = A + (-B)`**
*   在数字电路中，`-B` 就用 `B` 的**二进制补码**来表示。
*   **电路实现:**
    1.  将减数 `B` 的每一位**取反** (得到 `B` 的反码)。
    2.  将被减数 `A` 和取反后的 `B` 作为加法器的两个主要输入。
    3.  将加法器的初始**进位输入 (Cin) 设置为 `1`**。
*   **结果:** 电路执行的运算是 `A + B' + 1`，这在数学上完全等同于 `A - B`。通过这种方式，同一个加法器硬件可以复用于执行减法。

---

## ⚖️ 第四部分：比较器电路 

### **4.1 N位等值比较器 (Equality Comparator)**
*   **功能:** 判断两个N位二进制数 `A` 和 `B` 是否相等。
*   **逻辑:** `A = B` 当且仅当 `A` 和 `B` 的所有对应位都相等 (`aᵢ = bᵢ` for all i)。
*   **单位比较:** `aᵢ = bᵢ` 的逻辑表达式是 `aᵢbᵢ + aᵢ'bᵢ'`，这正是**同或门 (XNOR)** 的功能。
*   **电路实现:**
    1.  使用 `N` 个**同或门**对每一对位进行比较。
    2.  将所有同或门的输出送入一个 `N` 输入的**与门**。
    3.  只有当所有位都相等时，与门的输出 `eq` 才为 `1`。

### **4.2 N位数值比较器 (Magnitude Comparator)**
*   **功能:** 判断两个N位二进制数 `A` 和 `B` 的大小关系（`A>B`, `A=B`, `A<B`）。
*   **逻辑:** 比较过程从**最高有效位 (MSB)** 开始，逐位向低位进行：
    1.  比较 `aₙ₋₁` 和 `bₙ₋₁`。
    2.  如果 `aₙ₋₁ > bₙ₋₁` (`a=1, b=0`)，则 `A > B`，比较结束。
    3.  如果 `aₙ₋₁ < bₙ₋₁` (`a=0, b=1`)，则 `A < B`，比较结束。
    4.  如果 `aₙ₋₁ = bₙ₋₁`，则大小关系取决于下一位的比较结果，继续比较 `aₙ₋₂` 和 `bₙ₋₂`。
*   **级联实现 (Staged Design):**
    *   该逻辑可以通过一系列级联的“级”(stage)电路来实现。
    *   每一级电路接收来自更高级的比较结果 (`in_gt`, `in_eq`, `in_lt`)，并结合当前位的输入 (`aᵢ`, `bᵢ`)，生成传递给下一级的新的输出 (`out_gt`, `out_eq`, `out_lt`)。
*   **每级的逻辑方程:**
    *   `out_gt = in_gt + (in_eq · aᵢ · bᵢ')`  *(大于的条件)*
    *   `out_lt = in_lt + (in_eq · aᵢ' · bᵢ)`  *(小于的条件)*
    *   `out_eq = in_eq · (aᵢ ⊕ bᵢ)'`       *(等于的条件)*

---

## ✅ 第五部分：总结 (Summary)

本讲座系统地介绍了构建数字算术电路的核心模块和方法：
1.  **加法器:** **半加器**和**全加器**是二进制加法的基础模块，通过**行波进位**方式可以级联成任意位数的加法器。
2.  **减法器:** 利用**二进制补码**，可以通过在标准加法器外围增加一些逻辑门（取反）来实现减法，从而高效复用硬件。
3.  **比较器:** **等值比较器**和**数值比较器**是用于判断二进制数之间关系的重要电路，其中数值比较器采用高效的级联设计。